<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>title</title>
    <script src = 'http://code.jquery.com/jquery-latest.js'></script>
    <!-- CSS only -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">  
    <!-- JavaScript Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        function passing(){
            var rowPerPage = 4; // 한페이지에 보여줄 데이터의 갯수 지정
            $('#nav').remove();
            var $products = $('#products'); // 변수는 products라는 id값을 가진 태그 지정  

            $products.after('<div id="nav">');

            var $tr = $($products).find('tbody tr'); //find는 그 값을 찾고 변경까지 가능해짐.
            var rowTotals = $tr.length; //tr의 개수는 주식의 개수임. (db에서 tr을 받아오는 경우, data의 개수마다 달라지므로 이를 자동적으로 해결해줌)
            
            var pageTotal = Math.ceil(rowTotals/rowPerPage); //한페이지에 4개를 표시한다고 했고 db에서 받아오는 data의 개수별로 페이지를 표시해여하므로 그것을 지정해줌

            var i =0;
            for(; i < pageTotal; i++){
                $('<a href="#"></a>')       // 하이퍼 링크를 쓸때 a 를 사용한다
                    .attr('rel', i)
                    .html(i + 1)            //여기에 tag를 넣는다
                    .appendTo('#nav')
            }; 
            //js에서 for문 형성 그리고 위에서 10/4를 하면 2로 나옴 따라서 총 3p지만 2p까지 반복을 해야하는 상황

            $tr.addClass('off-screen')
                .slice(0, rowPerPage)
                .removeClass('off-screen');

            var $pagingLink = $('#nav a');

            $pagingLink.on('click', function(evt) {     // 맨 앞에 @를 넣으면 에러가 뜨는데 잘 모르겠음. 나중에 다시 볼 것
                evt.preventDefault();
                var $this = $(this); //내가 클릭한것을 의미함.
                if($this.hasClass('active')){   //만약 this가 액티브 클래스를 가지고 있으면 걍 return
                    return;
                }; //else를 적지 않아도 return을 통해 다음 줄로 넘어가게 됨. 코드는 불필요한 것을 줄이는 게 좋음. 따라서 else를 안넣고 진행함
                $pagingLink.removeClass('active'); //만약 그렇지 않으면 active 클래스를 지워라.
                $this.addClass('active'); //그리고 this에 active를 넣어줘라

                var currPage = $this.attr('rel');
                var startItem = currPage * rowPerPage;
                var endItem = startItem + rowPerPage;

                $tr.css('opacity', 0.0)
                    .addClass('off-screen')
                    .slice(startItem, endItem)
                    .removeClass('off-screen')
                    .animate({opacity:1},300);   //300ms 시간동안 이를 변경하겠다.
            });
            $pagingLink.filter(':first').addClass('active');
        }
    </script>
    <style>
        form {
            width : 500px;
        }
        table {
            border-collapse : collapse ;
            margin-bottom: 10px;
        }
        th, td {
            padding : 3px 10px;
        }
        .off-screen {
            display: none;
        }
        #nav {
            width: 500px;
            text-align: center;
        }
        #nav a {
            display: inline-block;
            padding: 3px 5px;
            margin-right: 10px;
            font-family: Tahoma;
            background: #ccc;
            color : #000;
            text-decoration: none;
        }
        #nav a.achieve {
            background: #333;
            color : #fff;
        }
        <link hred = "{{url_for('static', filename='css/header.css')}}" rel ="stylesheet"/>
    </style>
</head>
<body onload='passing()'>
    <div style="width:600px;height:600px">
    <canvas id="myChart" width="400" height="400"></canvas>
    {% if result %}
      <table id='products' border="1" class="table table-striped">
          <thead>
              <tr>
                  <th>No</th>
                  <th>cost</th>
                  <th>tax</th>
              </tr>
          </thead>
          <tbody>
              {% for list in result %}
                  <tr>
                      <td>{{list[0]}}</td>
                      <td>{{list[1]}}</td>
                      <td>{{list[2]}}</td>
                  </tr>
              {% endfor %}
          </tbody>
      </table>
    {% else %}
    <tr>Chart Table에 데이터가 없습니다.</tr>
    {% endif %}
    <script>
        const ctx = document.getElementById('myChart').getContext('2d');
        const myChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: {{label}},
                datasets: [{
                    label: 'COST',
                    data: {{data1}},
                    backgroundColor: [
                        'rgba(255, 99, 132, 0.1)',
                        'rgba(54, 162, 235, 0.2)',
                        'rgba(255, 206, 86, 0.5)',
                        'rgba(75, 192, 192, 0.2)',
                        'rgba(153, 102, 255, 0.2)',
                        'rgba(255, 159, 64, 0.2)',
                        'rgba(75, 192, 192, 0.2)',
                        'rgba(153, 102, 255, 0.2)'
                    ],
                    borderColor: [
                        'rgba(255, 99, 132, 1)',
                        'rgba(54, 162, 235, 1)',
                        'rgba(255, 206, 86, 1)',
                        'rgba(75, 192, 192, 1)',
                        'rgba(153, 102, 255, 1)',
                        'rgba(255, 159, 64, 1)',
                        'rgba(75, 192, 192, 1)',
                        'rgba(153, 102, 255, 1)'
                    ],
                    borderWidth: 2
                },
                {
                label: 'TAX',
                    data: {{data2}},
                    backgroundColor: [
                        'rgba(255, 99, 132, 0.1)',
                        'rgba(54, 162, 235, 0.2)',
                        'rgba(255, 206, 86, 0.5)',
                        'rgba(75, 192, 192, 0.2)',
                        'rgba(153, 102, 255, 0.2)',
                        'rgba(255, 159, 64, 0.2)',
                        'rgba(75, 192, 192, 0.2)',
                        'rgba(153, 102, 255, 0.2)'
                    ],
                    borderColor: [
                        'rgba(255, 99, 132, 1)',
                        'rgba(54, 162, 235, 1)',
                        'rgba(255, 206, 86, 1)',
                        'rgba(75, 192, 192, 1)',
                        'rgba(153, 102, 255, 1)',
                        'rgba(255, 159, 64, 1)',
                        'rgba(75, 192, 192, 1)',
                        'rgba(153, 102, 255, 1)'
                    ],
                    borderWidth: 2
                }
                ]
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });
    </script>
</div>
</body>
</html>

<!-- 
<div class="table-responsive">
    {% if result %}
      <table class="table table-striped">
          <thead>
              <tr>
                  <th>No</th>
                  <th>cost</th>
                  <th>tax</th>
              </tr>
          </thead>
          <tbody>
              {% for list in result %}
                  <tr>
                      <td>{{list[0]}}</td>
                      <td>{{list[1]}}</td>
                      <td>{{list[2]}}</td>
                  </tr>
              {% endfor %}
          </tbody>
      </table>
    {% else %}
    <tr>Chart Table에 데이터가 없습니다.</tr>
    {% endif %}
  </div>

  <table id='products' border="1">    <!-- 구버전이라서 이렇게 나올 수 있음 -->
    <!-- <thead>
        <th>No</th>
        <th>회사명</th>
        <th>주가</th>
    </thead>
    <tbody>
        <tr>
            <td>1</td>
            <td>삼성전자</td>
            <td>70700</td>
        </tr>
        <tr>
            <td>2</td>
            <td>SK하이닉스</td>
            <td>107000</td>
        </tr>
        <tr>
            <td>3</td>
            <td>기아</td>
            <td>88800</td>
        </tr>
        <tr>
            <td>4</td>
            <td>NAVER</td>
            <td>407500</td>
        </tr>
        <tr>
            <td>5</td>
            <td>카카오</td>
            <td>127000</td>
        </tr>
        <tr>
            <td>6</td>
            <td>골프존</td>
            <td>167500</td>
        </tr>
        <tr>
            <td>7</td>
            <td>현대차</td>
            <td>216000</td>
        </tr>
        <tr>
            <td>8</td>
            <td>신세계</td>
            <td>233000</td>
        </tr>
        <tr>
            <td>9</td>
            <td>대한항공</td>
            <td>29950</td>
        </tr>
        <tr>
            <td>10</td>
            <td>삼성중공업</td>
            <td>5890</td>
        </tr>
    </tbody>
</table> --> 